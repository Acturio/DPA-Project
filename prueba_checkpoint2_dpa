pyenv activate itam_intro_to_ds

# a nivel de la carpeta src

python

from src.utils.general import read_yaml_file, get_s3_credentials, get_api_token

s3_c = get_s3_credentials("conf/local/credentials.yaml")
s3_c

ry = read_yaml_file("conf/local/credentials.yaml")
ry

token = get_api_token("conf/local/credentials.yaml")
token

from src.pipeline.ingesta_almacenamiento import get_client, ingesta_inicial, get_s3_resource, guardar_ingesta, ingesta_consecutiva

cliente = get_client()
cliente

datos_his = ingesta_inicial(cliente, 300000)
type(datos_his)

s3_resource = get_s3_resource()
type(s3_resource)


bucket = "mapreduce1ajgc"
bucket_path_hist = "ingestion/initial/historic-inspections-"
bucket_path_cons = "ingestion/consecutive/consecutive-inspections-"

guardar_ingesta(bucket, bucket_path_hist, datos_his)

datos_cons = ingesta_consecutiva(cliente, '2021-01-01', 2000)
type(datos_cons)

guardar_ingesta(bucket, bucket_path_cons, datos_cons)

